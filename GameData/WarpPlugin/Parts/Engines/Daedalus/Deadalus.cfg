PART
{
	name = DeadalusEngine
	module = Part
	author = SargeRho

	scale = 1
	rescaleFactor = 1
	mesh = Deadalus.mu

	node_stack_top = 0.0, 2.5, 0.0, 0.0, 1.0, 0.0, 3
	node_stack_bottom = 0.0, -12, 0.0, 0.0, -1.0, 0.0, 3

	sound_vent_medium = engage
	sound_rocket_hard = running
	sound_vent_soft = disengage
	sound_explosion_low = flameout

	TechRequired = specializedFusionRockets
	entryCost = 12000000
	cost = 6000000
	category = Engine
	subcategory = 0

	title = #LOC_KSPIE_DeadlusEngine2_title			// "Daedalus" Inertial Confinement Fusion Engine
	manufacturer = #LOC_KSPIE_manuf31			// #LOC_KSPIE_manuf31 = Kerbal Ignition Facility Junkyard Co.
	description = #LOC_KSPIE_DeadlusEngine_descr		// #LOC_KSPIE_DeadlusEngine_descr = The Daedalus engine utilizes laser-induced inertial fusion for propulsion. Deuterium and helium-3 are compressed by a high-power ion gun to ultra-high densities, allowing the reaction to occur outside the ship without the need for bulky confinement vessels. The crew onboard are shielded from the intense neutron flux of the fusion reaction by the engine itself, but other nearby vessels or Kerbals are not so protected - Beware!

	// attachment rules: stack, srfAttach, allowStack, allowSrfAttach, allowCollision
	attachRules = 1,0,1,0,0

	mass = 72
	dragModelType = default
	maximum_drag = 0.2
	minimum_drag = 0.2
	angularDrag = 2
	crashTolerance = 7
	breakingForce = 1500
	breakingTorque = 1500
	maxTemp = 2000
	heatConductivity = 0.01
	emissiveConstant = 0.95

	EFFECTS
	{
		running_closed
		{
			AUDIO
			{
				channel = Ship
				clip = sound_rocket_hard
				volume = 0.0 0.0
				volume = 0.05 0.6
				volume = 1.0 1.5
				pitch = 0.0 1.2
				pitch = 1.0 2.0
				loop = true
			}
			MODEL_MULTI_PARTICLE:NEEDS[!FarFutureTechnologies]
			{
				modelName = Squad/FX/hydroLOXFlame
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 1.0 1.0
				speed = 0.0 2
				speed = 1.0 2
				localPosition = 0, 0, 2
			}

			MODEL_MULTI_PARTICLE:NEEDS[FarFutureTechnologies]
			{
				name = glow
				modelName = FarFutureTechnologies/FX/am-beam-core-375-01
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 0.01 0.1
				emission = 0.075 0.25
				emission = 1.0 1.0
				speed = 0.0 2
				speed = 1.0 2
				localOffset = 0, 0, 2
			}
			MODEL_MULTI_PARTICLE
			{
				name = plume
				modelName = WarpPlugin/FX/fusionplume
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 0.01 0.1
				emission = 0.075 0.25
				emission = 1.0 1.0
				speed = 0.0 2
				speed = 1.0 2
				localPosition = 0, 0, 2
			}
			MODEL_MULTI_PARTICLE:NEEDS[FarFutureTechnologies]
			{
				name = flare
				modelName = FarFutureTechnologies/FX/am-beam-plume-375-02
				transformName = thrustTransform
				emission = 0.0 0.0
				emission = 0.01 0.1
				emission = 0.075 0.5
				emission = 1.0 1.0
				speed = 0.0 2
				speed = 1.0 2
				localPosition = 0, 0, 2
			}
			MODEL_MULTI_PARTICLE
			{
				name = Glow
				modelName = WarpPlugin/FX/GCRHalo
				transformName = thrustTransform
				emission = 0.0 1
				emission = 1.0 2
				speed = 0 -0.5
				speed = 1 -0.5
				energy = 0 1
				energy = 1 2
				localPosition = 0, 0, 2
			}
		}
		engage
		{
			AUDIO
			{
				channel = Ship
				clip = sound_vent_soft
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
		flameout
		{
			PREFAB_PARTICLE
			{
				prefabName = fx_exhaustSparks_flameout_2
				transformName = thrustTransform
				oneShot = true
			}
			AUDIO
			{
				channel = Ship
				clip = sound_explosion_low
				volume = 1.0
				pitch = 2.0
				loop = false
			}
		}
	}

	MODULE
	{
		name = ModuleEnginesFX
		thrustVectorTransformName = thrustTransform
		exhaustDamage = True
		ignitionThreshold = 0.1
		minThrust = 0
		maxThrust = 3000
		heatProduction = 200
		fxOffset = 0, 0, 1

		exhaustDamageMaxRange = 1000		// default 10
		exhaustDamageMultiplier = 1000  	// default 165
		exhaustDamageMaxMutliplier = 1000 	// default 100

		PROPELLANT
		{
			name = FusionPellets
			ratio = 1
			DrawGauge = True
		}

		atmosphereCurve
		{
			key = 0 1500000
			key = 0.0001 0
		}
	}

	MODULE
	{
		name = DaedalusEngineController

		upgradeTechReq1 = DaedalusUpgradeA
		upgradeTechReq2 = DaedalusUpgradeB
		upgradeTechReq3 = DaedalusUpgradeC
		upgradeTechReq4 = DaedalusUpgradeD

		maxThrustMk1 = 720
		maxThrustMk2 = 1080
		maxThrustMk3 = 1620
		maxThrustMk4 = 2430
		maxThrustMk5 = 3000

		powerRequirementMk1 = 685
		powerRequirementMk2 = 1026
		powerRequirementMk3 = 1539
		powerRequirementMk4 = 2306
		powerRequirementMk5 = 2850

		powerProductionMk1 = 720
		powerProductionMk2 = 1080
		powerProductionMk3 = 1620
		powerProductionMk4 = 2430
		powerProductionMk5 = 3000

		wasteheatMk1 = 60
		wasteheatMk2 = 70
		wasteheatMk3 = 80
		wasteheatMk4 = 90
		wasteheatMk5 = 100

		thrustIspMk1 = 614400
		thrustIspMk2 = 768000
		thrustIspMk3 = 960000
		thrustIspMk4 = 1200000
		thrustIspMk5 = 1500000

		fuelName1 = FusionPellets
		effectName = running_closed

		higherScaleThrustExponent = 3
		lowerScaleThrustExponent = 4
		higherScaleIspExponent = 0.1
		lowerScaleIspExponent = 1
		powerThrottleExponent = 0
		ispThrottleExponent = 0

		killDivider = 100
		leathalDistance = 100
		maxTemp = 2000
		maxAtmosphereDensity = 0.0001
		partMass = 72
	}

	MODULE
	{
		name = IntegratedRadiator
		isPassive = true
		isDeployable = false
		convectiveBonus = 1
		radiatorArea = 50
		colorRatioExponent = 0			// Disabled coloring
		partMass = 72
		maintainResourceBuffers = false
	}

	MODULE
	{
		name = ModuleGimbal
		gimbalTransformName = thrustTransform
		gimbalRange = 1		// One degree of movement is provided through theses mechanisms, which consist of electrically driven ball screw actuators.
	}

	RESOURCE
	{
		name = LqdHe3
		amount = 805.024
		maxAmount = 805.024
	}

	RESOURCE
	{
		name = LqdDeuterium
		amount = 194.976
		maxAmount = 194.976
	}

		RESOURCE
		{
		name = ElectricCharge
		amount = 1000
		maxAmount = 1000
		}

	RESOURCE
	{
		name = FusionPellets
		amount = 1000
		maxAmount = 1000
	}

	RESOURCE
	{
		name = Megajoules
		amount = 200
		maxAmount = 200
		isTweakable = true
	}

	MODULE
	{
		name		=	ModuleElementRadioactiveDecay
		decayConstant 	=	1.0e-6
		resourceName	=	Megajoules
		decayProduct	=	WasteHeat
		convFactor	=	1
	}

	MODULE
	{
		name = ModuleDataTransmitter
		antennaType = DIRECT
		packetInterval = 0.1
		packetSize = 1
		packetResourceCost = 200
		requiredResource = ElectricCharge
		DeployFxModules = 0
		antennaPower = 4.0e+13
		antennaCombinable = False
	}

	MODULE
	{
		name = TweakScale
		type = stack_square
		defaultScale = 5
		scaleFactors = 5, 7.5, 10, 15, 20, 30, 40, 60, 80
		techRequired = specializedFusionRockets, specializedFusionRockets, specializedFusionRockets, specializedFusionRockets, specializedFusionRockets, specializedFusionRockets, specializedFusionRockets
	}

	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = #LOC_KSPIE_ConverterName13 	// #LOC_KSPIE_ConverterName13 = FusionPellets manufacturer
		StartActionName = #LOC_KSPIE_StartActionName13 	// #LOC_KSPIE_StartActionName13 = Start create FusionPellets
		StopActionName = #LOC_KSPIE_StopActionName13 	// #LOC_KSPIE_StopActionName13 = Stop create FusionPellets
		EfficiencyBonus = 10

		INPUT_RESOURCE
		{
			ResourceName = LqdHe3
			Ratio = 0.805024
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE
		{
			ResourceName = LqdDeuterium
			Ratio = 0.194976
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 10
		}
		OUTPUT_RESOURCE
		{
			ResourceName = FusionPellets
			Ratio = 0.36648388
			DumpExcess = False
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}
}
